(function(){"use strict";var O=(s=>(s.Complete="complete",s.Error="error",s))(O||{});let E;const wr=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&wr.decode();let V=null;function fr(){return(V===null||V.byteLength===0)&&(V=new Uint8Array(E.memory.buffer)),V}function $r(s,v){return s=s>>>0,wr.decode(fr().subarray(s,s+v))}let br=0;function re(s,v){const i=v(s.length*1,1)>>>0;return fr().set(s,i/1),br=s.length,i}let x=null;function Ar(){return(x===null||x.byteLength===0)&&(x=new Int32Array(E.memory.buffer)),x}function ee(s,v){return s=s>>>0,fr().subarray(s/1,s/1+v)}function ne(s,v,i){try{const p=E.__wbindgen_add_to_stack_pointer(-16),X=re(s,E.__wbindgen_malloc),Z=br;E.optimize(p,X,Z,v,i);var m=Ar()[p/4+0],C=Ar()[p/4+1],_=ee(m,C).slice();return E.__wbindgen_free(m,C*1,1),_}finally{E.__wbindgen_add_to_stack_pointer(16)}}async function te(s,v){if(typeof Response=="function"&&s instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(s,v)}catch(m){if(s.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",m);else throw m}const i=await s.arrayBuffer();return await WebAssembly.instantiate(i,v)}else{const i=await WebAssembly.instantiate(s,v);return i instanceof WebAssembly.Instance?{instance:i,module:s}:i}}function ie(){const s={};return s.wbg={},s.wbg.__wbindgen_throw=function(v,i){throw new Error($r(v,i))},s}function ae(s,v){return E=s.exports,Tr.__wbindgen_wasm_module=v,x=null,V=null,E}async function Tr(s){if(E!==void 0)return E;typeof s>"u"&&(s=new URL("/assets/image_opt_bg-CnWQSHJ3.wasm",self.location.href));const v=ie();(typeof s=="string"||typeof Request=="function"&&s instanceof Request||typeof URL=="function"&&s instanceof URL)&&(s=fetch(s));const{instance:i,module:m}=await te(await s,v);return ae(i,m)}var Q=(s=>(s.Png="image/png",s.Jpeg="image/jpeg",s))(Q||{});Object.values(Q);const Er=s=>{if(s)return new URL(s)};let Pr;const oe=async s=>{Pr||(Pr=await Tr(Er(s)))},ue=(s,v)=>{const i=new Uint8Array(s);return ne(i,(v==null?void 0:v.level)??3,(v==null?void 0:v.interlace)??!1)};var fe=function(){var s=self.location.href;return function(i){i=i||{};var i=typeof i<"u"?i:{},m,C;i.ready=new Promise(function(r,e){m=r,C=e});var _={},p;for(p in i)i.hasOwnProperty(p)&&(_[p]=i[p]);var X="./this.program",Z=function(r,e){throw e},le=!0,F="";function de(r){return i.locateFile?i.locateFile(r,F):F+r}var cr;F=self.location.href,s&&(F=s),F.indexOf("blob:")!==0?F=F.substr(0,F.lastIndexOf("/")+1):F="",cr=function(r){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)};var ve=i.print||console.log.bind(console),L=i.printErr||console.warn.bind(console);for(p in _)_.hasOwnProperty(p)&&(i[p]=_[p]);_=null,i.arguments&&i.arguments,i.thisProgram&&(X=i.thisProgram),i.quit&&(Z=i.quit);var q;i.wasmBinary&&(q=i.wasmBinary);var ge=i.noExitRuntime||!0;typeof WebAssembly!="object"&&er("no native wasm support detected");var $,lr=!1,Cr=new TextDecoder("utf8");function pe(r,e,n){for(var t=e+n,a=e;r[a]&&!(a>=t);)++a;return Cr.decode(r.subarray?r.subarray(e,a):new Uint8Array(r.slice(e,a)))}function Fr(r,e){if(!r)return"";for(var n=r+e,t=r;!(t>=n)&&y[t];)++t;return Cr.decode(y.subarray(r,t))}function _e(r,e,n,t){if(!(t>0))return 0;for(var a=n,f=n+t-1,c=0;c<r.length;++c){var o=r.charCodeAt(c);if(o>=55296&&o<=57343){var u=r.charCodeAt(++c);o=65536+((o&1023)<<10)|u&1023}if(o<=127){if(n>=f)break;e[n++]=o}else if(o<=2047){if(n+1>=f)break;e[n++]=192|o>>6,e[n++]=128|o&63}else if(o<=65535){if(n+2>=f)break;e[n++]=224|o>>12,e[n++]=128|o>>6&63,e[n++]=128|o&63}else{if(n+3>=f)break;e[n++]=240|o>>18,e[n++]=128|o>>12&63,e[n++]=128|o>>6&63,e[n++]=128|o&63}}return e[n]=0,n-a}function ye(r,e,n){return _e(r,y,e,n)}function he(r){for(var e=0,n=0;n<r.length;++n){var t=r.charCodeAt(n);t>=55296&&t<=57343&&(t=65536+((t&1023)<<10)|r.charCodeAt(++n)&1023),t<=127?++e:t<=2047?e+=2:t<=65535?e+=3:e+=4}return e}var me=new TextDecoder("utf-16le");function we(r,e){for(var n=r,t=n>>1,a=t+e/2;!(t>=a)&&rr[t];)++t;return n=t<<1,me.decode(y.subarray(r,n))}function be(r,e,n){if(n===void 0&&(n=2147483647),n<2)return 0;n-=2;for(var t=e,a=n<r.length*2?n/2:r.length,f=0;f<a;++f){var c=r.charCodeAt(f);z[e>>1]=c,e+=2}return z[e>>1]=0,e-t}function Ae(r){return r.length*2}function Te(r,e){for(var n=0,t="";!(n>=e/4);){var a=w[r+n*4>>2];if(a==0)break;if(++n,a>=65536){var f=a-65536;t+=String.fromCharCode(55296|f>>10,56320|f&1023)}else t+=String.fromCharCode(a)}return t}function Ee(r,e,n){if(n===void 0&&(n=2147483647),n<4)return 0;for(var t=e,a=t+n-4,f=0;f<r.length;++f){var c=r.charCodeAt(f);if(c>=55296&&c<=57343){var o=r.charCodeAt(++f);c=65536+((c&1023)<<10)|o&1023}if(w[e>>2]=c,e+=4,e+4>a)break}return w[e>>2]=0,e-t}function Pe(r){for(var e=0,n=0;n<r.length;++n){var t=r.charCodeAt(n);t>=55296&&t<=57343&&++n,e+=4}return e}function Re(r,e,n){for(var t=0;t<r.length;++t)N[e++>>0]=r.charCodeAt(t);N[e>>0]=0}function Ce(r,e){return r%e>0&&(r+=e-r%e),r}var dr,N,y,z,rr,w,U,Ur,Wr;function kr(r){dr=r,i.HEAP8=N=new Int8Array(r),i.HEAP16=z=new Int16Array(r),i.HEAP32=w=new Int32Array(r),i.HEAPU8=y=new Uint8Array(r),i.HEAPU16=rr=new Uint16Array(r),i.HEAPU32=U=new Uint32Array(r),i.HEAPF32=Ur=new Float32Array(r),i.HEAPF64=Wr=new Float64Array(r)}i.INITIAL_MEMORY;var B,Sr=[],Or=[],Dr=[];function Fe(){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)ke(i.preRun.shift());vr(Sr)}function Ue(){vr(Or)}function We(){if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)Oe(i.postRun.shift());vr(Dr)}function ke(r){Sr.unshift(r)}function Se(r){Or.unshift(r)}function Oe(r){Dr.unshift(r)}var M=0,G=null;function De(r){M++,i.monitorRunDependencies&&i.monitorRunDependencies(M)}function Me(r){if(M--,i.monitorRunDependencies&&i.monitorRunDependencies(M),M==0&&G){var e=G;G=null,e()}}i.preloadedImages={},i.preloadedAudios={};function er(r){i.onAbort&&i.onAbort(r),r+="",L(r),lr=!0,r="abort("+r+"). Build with -s ASSERTIONS=1 for more info.";var e=new WebAssembly.RuntimeError(r);throw C(e),e}var Ie="data:application/octet-stream;base64,";function Mr(r){return r.startsWith(Ie)}if(i.locateFile){var P="mozjpeg_enc.wasm";Mr(P)||(P=de(P))}else var P=new URL("/assets/mozjpeg_enc-DFv_b-h2.wasm",self.location.href).toString();function Ir(r){try{if(r==P&&q)return new Uint8Array(q);if(cr)return cr(r);throw"both async and sync fetching of the wasm failed"}catch(e){er(e)}}function je(){return!q&&le&&typeof fetch=="function"?fetch(P,{credentials:"same-origin"}).then(function(r){if(!r.ok)throw"failed to load wasm binary file at '"+P+"'";return r.arrayBuffer()}).catch(function(){return Ir(P)}):Promise.resolve().then(function(){return Ir(P)})}function Le(){var r={a:Vn};function e(c,o){var u=c.exports;i.asm=u,$=i.asm.C,kr($.buffer),B=i.asm.I,Se(i.asm.D),Me()}De();function n(c){e(c.instance)}function t(c){return je().then(function(o){var u=WebAssembly.instantiate(o,r);return u}).then(c,function(o){L("failed to asynchronously prepare wasm: "+o),er(o)})}function a(){return!q&&typeof WebAssembly.instantiateStreaming=="function"&&!Mr(P)&&typeof fetch=="function"?fetch(P,{credentials:"same-origin"}).then(function(c){var o=WebAssembly.instantiateStreaming(c,r);return o.then(n,function(u){return L("wasm streaming compile failed: "+u),L("falling back to ArrayBuffer instantiation"),t(n)})}):t(n)}if(i.instantiateWasm)try{var f=i.instantiateWasm(r,e);return f}catch(c){return L("Module.instantiateWasm callback failed with error: "+c),!1}return a().catch(C),{}}function vr(r){for(;r.length>0;){var e=r.shift();if(typeof e=="function"){e(i);continue}var n=e.func;typeof n=="number"?e.arg===void 0?B.get(n)():B.get(n)(e.arg):n(e.arg===void 0?null:e.arg)}}var He=0;function Ve(){return ge||He>0}function zn(r,e){}function xe(r,e){return void 0}var nr={};function jr(r){for(;r.length;){var e=r.pop(),n=r.pop();n(e)}}function tr(r){return this.fromWireType(U[r>>2])}var H={},I={},ir={},qe=48,Ne=57;function Lr(r){if(r===void 0)return"_unknown";r=r.replace(/[^a-zA-Z0-9_]/g,"$");var e=r.charCodeAt(0);return e>=qe&&e<=Ne?"_"+r:r}function Hr(r,e){return r=Lr(r),new Function("body","return function "+r+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(e)}function gr(r,e){var n=Hr(e,function(t){this.name=e,this.message=t;var a=new Error(t).stack;a!==void 0&&(this.stack=this.toString()+`
`+a.replace(/^Error(:[^\n]*)?\n/,""))});return n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},n}var Vr=void 0;function xr(r){throw new Vr(r)}function qr(r,e,n){r.forEach(function(o){ir[o]=e});function t(o){var u=n(o);u.length!==r.length&&xr("Mismatched type converter count");for(var l=0;l<r.length;++l)W(r[l],u[l])}var a=new Array(e.length),f=[],c=0;e.forEach(function(o,u){I.hasOwnProperty(o)?a[u]=I[o]:(f.push(o),H.hasOwnProperty(o)||(H[o]=[]),H[o].push(function(){a[u]=I[o],++c,c===f.length&&t(a)}))}),f.length===0&&t(a)}function ze(r){var e=nr[r];delete nr[r];var n=e.rawConstructor,t=e.rawDestructor,a=e.fields,f=a.map(function(c){return c.getterReturnType}).concat(a.map(function(c){return c.setterArgumentType}));qr([r],f,function(c){var o={};return a.forEach(function(u,l){var d=u.fieldName,g=c[l],h=u.getter,S=u.getterContext,R=c[l+a.length],j=u.setter,D=u.setterContext;o[d]={read:function(J){return g.fromWireType(h(S,J))},write:function(J,Nn){var Zr=[];j(D,J,R.toWireType(Zr,Nn)),jr(Zr)}}}),[{name:e.name,fromWireType:function(u){var l={};for(var d in o)l[d]=o[d].read(u);return t(u),l},toWireType:function(u,l){for(var d in o)if(!(d in l))throw new TypeError('Missing field:  "'+d+'"');var g=n();for(d in o)o[d].write(g,l[d]);return u!==null&&u.push(t,g),g},argPackAdvance:8,readValueFromPointer:tr,destructorFunction:t}]})}function Be(r,e,n,t,a){}function pr(r){switch(r){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+r)}}function Ge(){for(var r=new Array(256),e=0;e<256;++e)r[e]=String.fromCharCode(e);Nr=r}var Nr=void 0;function b(r){for(var e="",n=r;y[n];)e+=Nr[y[n++]];return e}var zr=void 0;function A(r){throw new zr(r)}function W(r,e,n){if(n=n||{},!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");var t=e.name;if(r||A('type "'+t+'" must have a positive integer typeid pointer'),I.hasOwnProperty(r)){if(n.ignoreDuplicateRegistrations)return;A("Cannot register type '"+t+"' twice")}if(I[r]=e,delete ir[r],H.hasOwnProperty(r)){var a=H[r];delete H[r],a.forEach(function(f){f()})}}function Ye(r,e,n,t,a){var f=pr(n);e=b(e),W(r,{name:e,fromWireType:function(c){return!!c},toWireType:function(c,o){return o?t:a},argPackAdvance:8,readValueFromPointer:function(c){var o;if(n===1)o=N;else if(n===2)o=z;else if(n===4)o=w;else throw new TypeError("Unknown boolean type size: "+e);return this.fromWireType(o[c>>f])},destructorFunction:null})}var _r=[],T=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Br(r){r>4&&--T[r].refcount===0&&(T[r]=void 0,_r.push(r))}function Ke(){for(var r=0,e=5;e<T.length;++e)T[e]!==void 0&&++r;return r}function Je(){for(var r=5;r<T.length;++r)if(T[r]!==void 0)return T[r];return null}function Qe(){i.count_emval_handles=Ke,i.get_first_emval=Je}function ar(r){switch(r){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var e=_r.length?_r.pop():T.length;return T[e]={refcount:1,value:r},e}}}function Xe(r,e){e=b(e),W(r,{name:e,fromWireType:function(n){var t=T[n].value;return Br(n),t},toWireType:function(n,t){return ar(t)},argPackAdvance:8,readValueFromPointer:tr,destructorFunction:null})}function yr(r){if(r===null)return"null";var e=typeof r;return e==="object"||e==="array"||e==="function"?r.toString():""+r}function Ze(r,e){switch(e){case 2:return function(n){return this.fromWireType(Ur[n>>2])};case 3:return function(n){return this.fromWireType(Wr[n>>3])};default:throw new TypeError("Unknown float type: "+r)}}function $e(r,e,n){var t=pr(n);e=b(e),W(r,{name:e,fromWireType:function(a){return a},toWireType:function(a,f){if(typeof f!="number"&&typeof f!="boolean")throw new TypeError('Cannot convert "'+yr(f)+'" to '+this.name);return f},argPackAdvance:8,readValueFromPointer:Ze(e,t),destructorFunction:null})}function rn(r,e){if(!(r instanceof Function))throw new TypeError("new_ called with constructor type "+typeof r+" which is not a function");var n=Hr(r.name||"unknownFunctionName",function(){});n.prototype=r.prototype;var t=new n,a=r.apply(t,e);return a instanceof Object?a:t}function en(r,e,n,t,a){var f=e.length;f<2&&A("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var c=e[1]!==null&&n!==null,o=!1,u=1;u<e.length;++u)if(e[u]!==null&&e[u].destructorFunction===void 0){o=!0;break}for(var l=e[0].name!=="void",d="",g="",u=0;u<f-2;++u)d+=(u!==0?", ":"")+"arg"+u,g+=(u!==0?", ":"")+"arg"+u+"Wired";var h="return function "+Lr(r)+"("+d+`) {
if (arguments.length !== `+(f-2)+`) {
throwBindingError('function `+r+" called with ' + arguments.length + ' arguments, expected "+(f-2)+` args!');
}
`;o&&(h+=`var destructors = [];
`);var S=o?"destructors":"null",R=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],j=[A,t,a,jr,e[0],e[1]];c&&(h+="var thisWired = classParam.toWireType("+S+`, this);
`);for(var u=0;u<f-2;++u)h+="var arg"+u+"Wired = argType"+u+".toWireType("+S+", arg"+u+"); // "+e[u+2].name+`
`,R.push("argType"+u),j.push(e[u+2]);if(c&&(g="thisWired"+(g.length>0?", ":"")+g),h+=(l?"var rv = ":"")+"invoker(fn"+(g.length>0?", ":"")+g+`);
`,o)h+=`runDestructors(destructors);
`;else for(var u=c?1:2;u<e.length;++u){var D=u===1?"thisWired":"arg"+(u-2)+"Wired";e[u].destructorFunction!==null&&(h+=D+"_dtor("+D+"); // "+e[u].name+`
`,R.push(D+"_dtor"),j.push(e[u].destructorFunction))}l&&(h+=`var ret = retType.fromWireType(rv);
return ret;
`),h+=`}
`,R.push(h);var J=rn(Function,R).apply(null,j);return J}function nn(r,e,n){if(r[e].overloadTable===void 0){var t=r[e];r[e]=function(){return r[e].overloadTable.hasOwnProperty(arguments.length)||A("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+r[e].overloadTable+")!"),r[e].overloadTable[arguments.length].apply(this,arguments)},r[e].overloadTable=[],r[e].overloadTable[t.argCount]=t}}function tn(r,e,n){i.hasOwnProperty(r)?((n===void 0||i[r].overloadTable!==void 0&&i[r].overloadTable[n]!==void 0)&&A("Cannot register public name '"+r+"' twice"),nn(i,r,r),i.hasOwnProperty(n)&&A("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),i[r].overloadTable[n]=e):(i[r]=e,n!==void 0&&(i[r].numArguments=n))}function an(r,e){for(var n=[],t=0;t<r;t++)n.push(w[(e>>2)+t]);return n}function on(r,e,n){i.hasOwnProperty(r)||xr("Replacing nonexistant public symbol"),i[r].overloadTable!==void 0&&n!==void 0?i[r].overloadTable[n]=e:(i[r]=e,i[r].argCount=n)}function un(r,e,n){var t=i["dynCall_"+r];return n&&n.length?t.apply(null,[e].concat(n)):t.call(null,e)}function fn(r,e,n){return r.includes("j")?un(r,e,n):B.get(e).apply(null,n)}function sn(r,e){var n=[];return function(){n.length=arguments.length;for(var t=0;t<arguments.length;t++)n[t]=arguments[t];return fn(r,e,n)}}function Y(r,e){r=b(r);function n(){return r.includes("j")?sn(r,e):B.get(e)}var t=n();return typeof t!="function"&&A("unknown function pointer with signature "+r+": "+e),t}var Gr=void 0;function Yr(r){var e=Xr(r),n=b(e);return k(e),n}function cn(r,e){var n=[],t={};function a(f){if(!t[f]&&!I[f]){if(ir[f]){ir[f].forEach(a);return}n.push(f),t[f]=!0}}throw e.forEach(a),new Gr(r+": "+n.map(Yr).join([", "]))}function ln(r,e,n,t,a,f){var c=an(e,n);r=b(r),a=Y(t,a),tn(r,function(){cn("Cannot call "+r+" due to unbound types",c)},e-1),qr([],c,function(o){var u=[o[0],null].concat(o.slice(1));return on(r,en(r,u,null,a,f),e-1),[]})}function dn(r,e,n){switch(e){case 0:return n?function(a){return N[a]}:function(a){return y[a]};case 1:return n?function(a){return z[a>>1]}:function(a){return rr[a>>1]};case 2:return n?function(a){return w[a>>2]}:function(a){return U[a>>2]};default:throw new TypeError("Unknown integer type: "+r)}}function vn(r,e,n,t,a){e=b(e),a===-1&&(a=4294967295);var f=pr(n),c=function(l){return l};if(t===0){var o=32-8*n;c=function(l){return l<<o>>>o}}var u=e.includes("unsigned");W(r,{name:e,fromWireType:c,toWireType:function(l,d){if(typeof d!="number"&&typeof d!="boolean")throw new TypeError('Cannot convert "'+yr(d)+'" to '+this.name);if(d<t||d>a)throw new TypeError('Passing a number "'+yr(d)+'" from JS side to C/C++ side to an argument of type "'+e+'", which is outside the valid range ['+t+", "+a+"]!");return u?d>>>0:d|0},argPackAdvance:8,readValueFromPointer:dn(e,f,t!==0),destructorFunction:null})}function gn(r,e,n){var t=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],a=t[e];function f(c){c=c>>2;var o=U,u=o[c],l=o[c+1];return new a(dr,l,u)}n=b(n),W(r,{name:n,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{ignoreDuplicateRegistrations:!0})}function pn(r,e){e=b(e);var n=e==="std::string";W(r,{name:e,fromWireType:function(t){var a=U[t>>2],f;if(n)for(var c=t+4,o=0;o<=a;++o){var u=t+4+o;if(o==a||y[u]==0){var l=u-c,d=Fr(c,l);f===void 0?f=d:(f+="\0",f+=d),c=u+1}}else{for(var g=new Array(a),o=0;o<a;++o)g[o]=String.fromCharCode(y[t+4+o]);f=g.join("")}return k(t),f},toWireType:function(t,a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));var f,c=typeof a=="string";c||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Int8Array||A("Cannot pass non-string to std::string"),n&&c?f=function(){return he(a)}:f=function(){return a.length};var o=f(),u=hr(4+o+1);if(U[u>>2]=o,n&&c)ye(a,u+4,o+1);else if(c)for(var l=0;l<o;++l){var d=a.charCodeAt(l);d>255&&(k(u),A("String has UTF-16 code units that do not fit in 8 bits")),y[u+4+l]=d}else for(var l=0;l<o;++l)y[u+4+l]=a[l];return t!==null&&t.push(k,u),u},argPackAdvance:8,readValueFromPointer:tr,destructorFunction:function(t){k(t)}})}function _n(r,e,n){n=b(n);var t,a,f,c,o;e===2?(t=we,a=be,c=Ae,f=function(){return rr},o=1):e===4&&(t=Te,a=Ee,c=Pe,f=function(){return U},o=2),W(r,{name:n,fromWireType:function(u){for(var l=U[u>>2],d=f(),g,h=u+4,S=0;S<=l;++S){var R=u+4+S*e;if(S==l||d[R>>o]==0){var j=R-h,D=t(h,j);g===void 0?g=D:(g+="\0",g+=D),h=R+e}}return k(u),g},toWireType:function(u,l){typeof l!="string"&&A("Cannot pass non-string to C++ string type "+n);var d=c(l),g=hr(4+d+e);return U[g>>2]=d>>o,a(l,g+4,d+e),u!==null&&u.push(k,g),g},argPackAdvance:8,readValueFromPointer:tr,destructorFunction:function(u){k(u)}})}function yn(r,e,n,t,a,f){nr[r]={name:b(e),rawConstructor:Y(n,t),rawDestructor:Y(a,f),fields:[]}}function hn(r,e,n,t,a,f,c,o,u,l){nr[r].fields.push({fieldName:b(e),getterReturnType:n,getter:Y(t,a),getterContext:f,setterArgumentType:c,setter:Y(o,u),setterContext:l})}function mn(r,e){e=b(e),W(r,{isVoid:!0,name:e,argPackAdvance:0,fromWireType:function(){},toWireType:function(n,t){}})}var wn={};function bn(r){var e=wn[r];return e===void 0?b(r):e}function Kr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function An(r){return r===0?ar(Kr()):(r=bn(r),ar(Kr()[r]))}function Tn(r){r>4&&(T[r].refcount+=1)}function En(r,e){var n=I[r];return n===void 0&&A(e+" has unknown type "+Yr(r)),n}function Pn(r){for(var e="",n=0;n<r;++n)e+=(n!==0?", ":"")+"arg"+n;for(var t="return function emval_allocator_"+r+`(constructor, argTypes, args) {
`,n=0;n<r;++n)t+="var argType"+n+" = requireRegisteredType(Module['HEAP32'][(argTypes >>> 2) + "+n+'], "parameter '+n+`");
var arg`+n+" = argType"+n+`.readValueFromPointer(args);
args += argType`+n+`['argPackAdvance'];
`;return t+="var obj = new constructor("+e+`);
return __emval_register(obj);
}
`,new Function("requireRegisteredType","Module","__emval_register",t)(En,i,ar)}var Jr={};function Rn(r){return r||A("Cannot use deleted val. handle = "+r),T[r].value}function Cn(r,e,n,t){r=Rn(r);var a=Jr[e];return a||(a=Pn(e),Jr[e]=a),a(r,n,t)}function Fn(){er()}function Un(r,e,n){y.copyWithin(r,e,e+n)}function Wn(r){try{return $.grow(r-dr.byteLength+65535>>>16),kr($.buffer),1}catch{}}function kn(r){var e=y.length;r=r>>>0;var n=2147483648;if(r>n)return!1;for(var t=1;t<=4;t*=2){var a=e*(1+.2/t);a=Math.min(a,r+100663296);var f=Math.min(n,Ce(Math.max(r,a),65536)),c=Wn(f);if(c)return!0}return!1}var Qr={};function Sn(){return X||"./this.program"}function K(){if(!K.strings){var r=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:r,_:Sn()};for(var n in Qr)e[n]=Qr[n];var t=[];for(var n in e)t.push(n+"="+e[n]);K.strings=t}return K.strings}var or={mappings:{},buffers:[null,[],[]],printChar:function(r,e){var n=or.buffers[r];e===0||e===10?((r===1?ve:L)(pe(n,0)),n.length=0):n.push(e)},varargs:void 0,get:function(){or.varargs+=4;var r=w[or.varargs-4>>2];return r},getStr:function(r){var e=Fr(r);return e},get64:function(r,e){return r}};function On(r,e){var n=0;return K().forEach(function(t,a){var f=e+n;w[r+a*4>>2]=f,Re(t,f),n+=t.length+1}),0}function Dn(r,e){var n=K();w[r>>2]=n.length;var t=0;return n.forEach(function(a){t+=a.length+1}),w[e>>2]=t,0}function Mn(r){qn(r)}function In(r){return 0}function jn(r,e,n,t,a){}function Ln(r,e,n,t){for(var a=0,f=0;f<n;f++){for(var c=w[e+f*8>>2],o=w[e+(f*8+4)>>2],u=0;u<o;u++)or.printChar(r,y[c+u]);a+=o}return w[t>>2]=a,0}function Hn(r){}Vr=i.InternalError=gr(Error,"InternalError"),Ge(),zr=i.BindingError=gr(Error,"BindingError"),Qe(),Gr=i.UnboundTypeError=gr(Error,"UnboundTypeError");var Vn={B:xe,l:ze,p:Be,y:Ye,x:Xe,i:$e,f:ln,c:vn,b:gn,j:pn,e:_n,m:yn,a:hn,z:mn,g:Br,u:An,k:Tn,n:Cn,h:Fn,r:Un,d:kn,s:On,t:Dn,A:Mn,w:In,o:jn,v:Ln,q:Hn};Le(),i.___wasm_call_ctors=function(){return(i.___wasm_call_ctors=i.asm.D).apply(null,arguments)};var hr=i._malloc=function(){return(hr=i._malloc=i.asm.E).apply(null,arguments)},k=i._free=function(){return(k=i._free=i.asm.F).apply(null,arguments)},Xr=i.___getTypeName=function(){return(Xr=i.___getTypeName=i.asm.G).apply(null,arguments)};i.___embind_register_native_and_builtin_types=function(){return(i.___embind_register_native_and_builtin_types=i.asm.H).apply(null,arguments)},i.dynCall_jiji=function(){return(i.dynCall_jiji=i.asm.J).apply(null,arguments)};var ur;function xn(r){this.name="ExitStatus",this.message="Program terminated with exit("+r+")",this.status=r}G=function r(){ur||mr(),ur||(G=r)};function mr(r){if(M>0||(Fe(),M>0))return;function e(){ur||(ur=!0,i.calledRun=!0,!lr&&(Ue(),m(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),We()))}i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),e()},1)):e()}i.run=mr;function qn(r,e){Ve()||(i.onExit&&i.onExit(r),lr=!0),Z(r,new xn(r))}if(i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return mr(),i.ready}}(),Rr=(s=>(s[s.GRAYSCALE=1]="GRAYSCALE",s[s.RGB=2]="RGB",s[s.YCbCr=3]="YCbCr",s))(Rr||{});Rr.YCbCr;let sr;const se=async s=>{sr||(sr=await fe(Er(s)))},ce=(s,v)=>sr.encode(s.data,s.width,s.height,v);self.onmessage=async s=>{const{file:v,init:i}=s.data??{};if(!v)return;const{buffer:m,data:C}=v;switch(i.assetType){case Q.Png:try{if(!m){self.postMessage({type:O.Error,output:"Invalid PNG data"});return}await oe(i.oxipngWasm);const _=s.data.options,p=ue(m,_);self.postMessage({type:O.Complete,output:p})}catch(_){self.postMessage({type:O.Error,output:_})}break;case Q.Jpeg:try{if(!C){self.postMessage({type:O.Error,output:"Invalid JPG data"});return}await se(i.mozjpegWasm);const _=s.data.options,p=ce(C,_);self.postMessage({type:O.Complete,output:p})}catch(_){self.postMessage({type:O.Error,output:_})}break;default:console.log("Error: unknown worker command",s.data),self.postMessage({type:O.Error,output:"Unknown command"})}}})();
